\documentclass{article}
%\documentclass[aos,preprint]{imsart}
\usepackage[utf8]{inputenc} 
\usepackage{amstext, amsmath,latexsym,amsbsy,amssymb}
\usepackage{hyperref}
\usepackage{amsfonts}
\usepackage[accepted]{icml2017} 
\usepackage{array}
\usepackage{esint}
%\usepackage[authoryear]{natbib}
%\usepackage{mathtools}
%\textwidth=6.2in 
%\textheight=9in 
%\topmargin -.5in
%\setlength{\oddsidemargin}{0.25in}
%\setlength{\headheight}{0.3in}
%\setlength{\headsep}{0.4in}
%\setlength{\footskip}{0.25in}
%\newcommand{\hk}{\hspace*{.26in}}
%\newcommand{\hhk}{\hspace*{.52in}}
%\newcommand{\s}{\vspace*{.26in}}
\usepackage[pdftex]{graphicx}
\usepackage{amsfonts,amsmath,amssymb,amsthm}
\usepackage{epsf}
%\usepackage{fancyheadings}
\usepackage{graphics}
\usepackage{psfrag}
\usepackage{times}
\usepackage{epsfig}
\usepackage{subfig}
\usepackage[titletoc]{appendix}
\usepackage{multirow}
\usepackage{hhline}
\usepackage{color}
\usepackage{bbm}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{booktabs}
\usepackage{hyperref}

% colorise the tables
\usepackage{colortbl} 
\definecolor{header_color}{rgb}{0.74,0.88,0.91}
\definecolor{even_color}{rgb}{0.9,0.9,0.9}
\definecolor{subheader_color}{rgb}{0.85,0.93,0.95}
\definecolor{childheader_color}{rgb}{1.0,0.93,0.87}

\definecolor{ccolor_best}{rgb}{1.0,0.9,0.9}
\definecolor{ccolor_wrong}{rgb}{1.0,0.85,0.85}

\makeatother

\RequirePackage{natbib}
%\RequirePackage[OT1]{fontenc}
%\RequirePackage{amsthm,amsmath}
%\RequirePackage[numbers]{natbib}
%\RequirePackage[colorlinks,citecolor=blue,urlcolor=blue]{hyperref}
%\RequirePackage[dvips]{hyperref}
%\usepackage{natbib}
\bibliographystyle{plainnat}

\newcommand{\myline}{1.5}
\newcommand{\trace}{\ensuremath{tr}}

\long\def\comment#1{}
\renewcommand\vec[1]{\ensuremath\boldsymbol{#1}}
\newcommand{\Sdd}{\ensuremath{S_{d_2}^{++}}}
\renewcommand{\trace}{\ensuremath{\operatorname{tr}}}
\newcommand{\Ocal}{\ensuremath{\mathcal{O}}}
\newcommand{\Gcal}{\ensuremath{\mathcal{G}}}
\newcommand{\Xcal}{\ensuremath{\mathcal{X}}}

\newcommand{\Hcal}{\ensuremath{\mathcal{H}}}
\newcommand{\Hbold}{\ensuremath{\boldsymbol{H}}}

% Margin note
\setlength{\marginparwidth}{.58in}
\newcommand{\lnnote}[1]{
\marginpar{{\tiny{
{\bf (LN:} {#1}{\bf ) }}
}}}

\comment{
% text margin
\setlength{\topmargin}{0 in}
\setlength{\textwidth}{5.5 in}
\setlength{\textheight}{8 in}
\setlength{\oddsidemargin}{0.5 in}
}

\theoremstyle{plain}

\newtheorem{innercustomthm}{Theorem}
\newenvironment{customthm}[1]
  {\renewcommand\theinnercustomthm{#1}\innercustomthm}
  {\endinnercustomthm}
  
  \newtheorem{innercustomlem}{Lemma}
\newenvironment{customlem}[1]
  {\renewcommand\theinnercustomlem{#1}\innercustomlem}
  {\endinnercustomlem}

  \newtheorem{innercustomprop}{Proposition}
\newenvironment{customprop}[1]
  {\renewcommand\theinnercustomprop{#1}\innercustomprop}
  {\endinnercustomprop}
\theoremstyle{plain}

\newtheorem{theorem}{Theorem}

\numberwithin{theorem}{section}

\newtheorem{proposition}{Proposition}

\numberwithin{proposition}{section}

\newtheorem{lemma}{Lemma}

\numberwithin{lemma}{section}

\newtheorem{definition}{Definition}

\numberwithin{definition}{section}

\newtheorem{condition}{Condition}

\numberwithin{condition}{section}

\newtheorem{problem}{Problem}

\numberwithin{problem}{section}

\newtheorem{corollary}{Corollary}

\numberwithin{corollary}{section}

\newtheorem{assumption}{Assumption}

\numberwithin{assumption}{section}

\newtheorem{example}{Example}

\numberwithin{example}{section}

\newtheorem{conjecture}{Conjecture}

\numberwithin{conjecture}{section}

%\newtheorem{example}{Example}


\theoremstyle{definition}

\newtheorem{remark}{Remark}

\numberwithin{remark}{section}

\begin{document}
\twocolumn[
\icmltitle{Multilevel Clustering via Wasserstein Means}
% It is OKAY to include author information, even for blind
% submissions: the style file will automatically remove it for you
% unless you've provided the [accepted] option to the icml2017
% package.

% list of affiliations. the first argument should be a (short)
% identifier you will use later to specify author affiliations
% Academic affiliations should list Department, University, City, Region, Country
% Industry affiliations should list Company, City, Region, Country

% you can specify symbols, otherwise they are numbered in order
% ideally, you should not use this facility. affiliations will be numbered
% in order of appearance and this is the preferred way.
\icmlsetsymbol{equal}{*}

\begin{icmlauthorlist}
\icmlauthor{Nhat Ho}{mi}
\icmlauthor{XuanLong Nguyen}{mi}
\icmlauthor{Mikhail Yurochkin}{mi}
\icmlauthor{Hung Hai Bui}{ado}
\icmlauthor{Viet Huynh}{dea}
\icmlauthor{Dinh Phung}{dea}
\end{icmlauthorlist}

\icmlaffiliation{mi}{Department of Statistics, University of Michigan, USA.}
\icmlaffiliation{dea}{Center for Pattern Recognition and Data Analytics (PRaDA), Deakin University, Australia}
\icmlaffiliation{ado}{Adobe Research.}

\icmlcorrespondingauthor{Nhat Ho}{minhnhat@umich.edu}


% You may provide any keywords that you 
% find helpful for describing your paper; these are used to populate 
% the "keywords" metadata in the PDF but will not be shown in the document
%\icmlkeywords{Factorization Machines, Learning Interactions, Indian Buffet Process}
\icmlkeywords{Multilevel Clustering, Optimal Transport}

\vskip 0.3in
]

% this must go after the closing bracket ] following \twocolumn[ ...

% This command actually creates the footnote in the first column
% listing the affiliations and the copyright notice.
% The command takes one argument, which is text to display at the start of the footnote.
% The \icmlEqualContribution command is standard text for equal contribution.
% Remove it (just {}) if you do not need this facility.

\printAffiliationsAndNotice{}

\begin{abstract} 
We propose a novel approach to the problem of multilevel clustering, which aims to 
simultaneously partition data in each group and discover grouping patterns among groups
in a potentially large hierarchically structured corpus of data.
Our method involves a joint optimization formulation over several spaces of discrete probability measures,
which are endowed with Wasserstein distance metrics. We propose a number of variants
of this problem, which admit fast optimization algorithms, by exploiting the connection to the
problem of finding Wasserstein barycenters.  Consistency properties are established
for the estimates of both local and global clusters.
Finally, experiment results with both synthetic and real data are presented to demonstrate the 
flexibility and scalability of the proposed approach. \footnote{Code is available at \url{https://github.com/moonfolk/Multilevel-Wasserstein-Means}}
\end{abstract} 
\section{Introduction} \label{Section:introduction}
\input{arxiv_nested_introduction}

\section{Background} \label{Section:prelim}
\input{arxiv_nested_prelim}


\section{Clustering with multilevel structure data} \label{Section:multilevel_Wasserstein}
\input{arxiv_nested_multilevel}


\section{Consistency results} \label{Section:consistency_multilevel_Kmeans}
\input{arxiv_nested_consistency}

\section{Empirical studies} \label{Section:data_analysis}
\input{arxiv_nested_simulation}
\vspace{-6pt}
\section{Discussion} \label{Section:discussion}
We have proposed an optimization based approach to multilevel clustering 
using Wasserstein metrics. There are several possible directions for extensions.
Firstly, we have only considered continuous data; it is of interest to extend 
our formulation to discrete data. Secondly, our 
method requires knowledge of the numbers of clusters both in local and global clustering. 
When these numbers are unknown, it seems reasonable to incorporate penalty
on the model complexity. Thirdly,  our formulation does not directly account for the ``noise'' distribution away from the 
(Wasserstein) means.  To improve the robustness, it may be desirable to
make use of the first-order Wasserstein metric instead of the second-order one. 
Finally, we are interested in extending our approach to richer settings of 
hierarchical data, such as one when group level-context is available. 
\vspace{-6pt}
\paragraph{Acknowledgement.} This research is supported in part by grants
NSF CAREER DMS-1351362, NSF CNS-1409303, the Margaret and Herman Sokol 
Faculty Award and research gift from Adobe Research (XN). 
DP gratefully acknowledges the partial support from the 
Australian Research Council (ARC) and AOARD (FA2386-16-1-4138).

\newpage
\bibliography{Nhat,NPB,Nguyen,MY_ref}

\newpage
\begin{center}
\textbf{\Large Appendix A}
\end{center}
\input{arxiv_nested_appendix_a}

\begin{center}
\textbf{\Large Appendix B}
\end{center}
\input{arxiv_nested_appendix_b}

\begin{center}
\textbf{\Large Appendix C}
\end{center}
\input{arxiv_nested_appendix_c}

\begin{center}
\textbf{\Large Appendix D}
\end{center}
\input{arxiv_nested_appendix_d}
\end{document}




