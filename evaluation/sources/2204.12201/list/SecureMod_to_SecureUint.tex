\begin{figure}[!t]
%\scriptsize
\begin{minipage}{\linewidth}
\begin{lstlisting}[language=C++, caption={
Casting from \secmod\ to \secuint.}, style=mystyleb, label=list:secmod2secuint,
%framexrightmargin=-37pt,
% xleftmargin=0.4cm,
% xrightmargin=-0.12\linewidth,
% linewidth=0.88\linewidth
]
template <int Size>
SecureUint to_SecureUint<Size>(SecureMod x)
{
SecureMod one(1);
    auto & t = SecureMod::t;
    vector<SecureUint<Size>> v;
    for (int i = 1; i < t; i++)
    {
        auto si = SecureUint<Size>(i);
        auto eq = one - pow(x-i, t-1);
        v.push_back(si * SecureBool(eq));
    }
    return sum(v);
}
\end{lstlisting}
\end{minipage}
% \vspace{\lstbspace}
\vspace{-0.5cm} 
\end{figure}
