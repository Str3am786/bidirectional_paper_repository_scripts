\begin{figure}[!t]
%\scriptsize
\begin{minipage}{\linewidth}
\begin{lstlisting}[language=C++, caption={
Casting from \secmod\ to \secint.}, style=mystyleb, label=list:secmod2secint,
%framexrightmargin=-37pt,
% xleftmargin=0.4cm,
% xrightmargin=-0.12\linewidth,
% linewidth=0.88\linewidth
]
template <int Size>
SecureInt to_SecureInt<Size>(SecureMod x)
{
    auto u = to_SecureUint<Size>(x);
    SecureInt<Size> pos(u);
    auto max = 1 << s;
    auto diff = max - SecureMod::t;
    u = to_SecureUint<Size>(diff + x);
    SecureInt<Size> neg(u);
    auto & isNeg = pos[s-1];
    return isNeg * neg + (1-isNeg) * pos;
}
\end{lstlisting}
\end{minipage}
% \vspace{\lstbspace}
\vspace{-0.5cm} 

\end{figure}
